<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Base de donn√©es - Personnages SWGOH</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background: linear-gradient(180deg, #071428, #0b2540);
            color: #e6f0ff;
            font-family: 'Inter', Arial, sans-serif;
        }

        h1,
        h2 {
            color: #ffcc33;
            text-align: center;
            margin-bottom: 1rem;
        }

        .section {
            background: rgba(255, 255, 255, 0.05);
            padding: 2rem;
            border-radius: 12px;
            margin-top: 2rem;
        }

        .code-block {
            background: #111;
            color: #0f0;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            overflow-x: auto;
            margin-top: 1rem;
        }

        .img-placeholder {
            display: block;
            width: 80%;
            margin: 15px auto;
            border-radius: 12px;
            border: 1px solid #444;
        }

        .btn-back {
            background-color: #ffcc33;
            color: #071428;
            font-weight: bold;
            border-radius: 10px;
            padding: 10px 20px;
            margin-top: 20px;
            transition: 0.3s;
        }

        .btn-back:hover {
            background-color: #e6b800;
            color: #fff;
        }

        code {
            background-color: #1e1e1e;
            color: #00ffcc;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.95em;
            word-break: break-word;
        }
    </style>
</head>

<body>
    <div class="container py-5">
        <h1><u>Base de donn√©es - Personnages</u></h1>

        <!-- Pr√©sentation de la base -->
        <div class="section">
            <h2>Pr√©sentation</h2>
            <p>
                La base de donn√©es centralise toutes les informations sur les personnages du jeu <em>Star Wars: Galaxy
                    of Heroes</em>.
                Elle permet de g√©n√©rer dynamiquement le fichier <code>units.json</code>, utilis√© par la page de filtre
                des unit√©s.
            </p>
            <img src="image-projet/swgoh-bdd-accueil.jpg" alt="Base de donn√©es SWGOH" class="img-placeholder">
            <br><br>
            <p>page d'accueil permettant de choisir sur quelle base de donn√©es on va travailler entre la base de donn√©es
                qui g√®re les unit√©s ou les vaisseaux</p>
        </div>

        <!-- Section UML et tables SQL -->
        <div class="section mt-4">
            <h2>Diagramme UML et structure des tables</h2>

            <!-- Diagramme UML -->
            <p>
                Le diagramme ci-dessous illustre les relations entre les tables de la base de donn√©es des unit√©s
                (personnages).
                Chaque personnage peut appartenir √† plusieurs factions, ce qui justifie la table d'association
                <code>unit_factions</code>.
            </p>
            <div class="text-center">
                <img src="image-projet/uml-swgoh-database.png" alt="Diagramme UML base units" class="img-placeholder">
            </div>

            <!-- Explication des tables -->
            <p class="mt-3">
                La base de donn√©es contient trois tables principales :
            </p>
            <ul>
                <li>
                    <strong>units</strong> : contient les informations de chaque personnage :
                    <ul>
                        <li><strong>id</strong> : identifiant unique</li>
                        <li><strong>name-en / nom-fr</strong> : nom en anglais et en fran√ßais</li>
                        <li><strong>role / role-fr</strong> : r√¥le du personnage (attaquant, tank, soutien, soigneur)
                        </li>
                        <li><strong>alignment / alignment-fr</strong> : alignement (c√¥t√© lumineux, obscur ou neutre)
                        </li>
                        <li><strong>page</strong> : lien vers la page d√©taill√©e</li>
                        <li><strong>image</strong> : URL de l‚Äôimage du personnage</li>
                    </ul>
                </li>
                <li>
                    <strong>factions</strong> : contient toutes les factions possibles :
                    <ul>
                        <li><strong>id</strong> : identifiant unique</li>
                        <li><strong>name / nom-fr</strong> : nom de la faction en anglais et en fran√ßais</li>
                    </ul>
                </li>
                <li>
                    <strong>unit_factions</strong> : table d‚Äôassociation entre unit√©s et factions :
                    <ul>
                        <li><strong>unit_id</strong> : identifiant du personnage</li>
                        <li><strong>faction_id</strong> : identifiant de la faction</li>
                        <li>Permet de g√©rer les personnages appartenant √† plusieurs factions</li>
                    </ul>
                </li>
            </ul>

            <!-- Explication simple du fonctionnement -->
            <p class="mt-3">
                Lorsqu‚Äôune nouvelle unit√© est ajout√©e √† la base, elle est ins√©r√©e dans la table <strong>units</strong>,
                ses factions sont ajout√©es dans <strong>factions</strong> si elles n‚Äôexistent pas d√©j√†, et les relations
                sont cr√©√©es dans <strong>unit_factions</strong>.
                Cette structure permet de g√©n√©rer facilement le fichier <code>units.json</code> utilis√© par la page de
                filtrage des personnages.
            </p>

            <!-- Bouton de t√©l√©chargement du script SQL -->
            <div class="text-center mt-4">
                <a href="../projet/swgoh-database-unit.sql"
                download="swgoh-database-unit.sql"
                class="btn btn-primary"
                style="padding: 10px 20px; border-radius: 8px; background-color: #007bff; color: white; text-decoration: none;">
                    üì• T√©l√©charger le script SQL de cr√©ation des tables
                </a>
            </div>
        </div>

        <!-- Section Ajout de Factions -->
        <div class="section mt-4">
            <h2>Gestion des factions</h2>

            <p>
                Cette page permet de cr√©er de nouvelles factions pour le jeu (par exemple : Jedi, Empire, Rebelles,
                etc.) et de les ajouter √† la base de donn√©es.
                Elle utilise un formulaire PHP pour saisir le nom anglais et le nom fran√ßais de la faction.
            </p>

            <!-- Capture d'√©cran -->
            <div class="text-center">
                <img src="image-projet/faction-bdd.jpg" alt="Page Ajout de faction" class="img-placeholder">
            </div>

            <!-- Explications -->
            <h5 class="mt-3">Fonctionnement</h5>
            <ul>
                <li>Le formulaire √† gauche permet d‚Äôentrer le <strong>nom anglais</strong> (obligatoire) et le
                    <strong>nom fran√ßais</strong> (optionnel) de la faction.</li>
                <li>Le bouton <strong>Ajouter la faction</strong> envoie les donn√©es au serveur via PHP.</li>
                <li>Si le nom anglais est vide, une erreur est affich√©e pour pr√©venir l‚Äôutilisateur.</li>
                <li>Le c√¥t√© droit de la page affiche toutes les factions existantes dans un tableau avec leurs noms
                    anglais et fran√ßais.</li>
                <li>Chaque ajout est stock√© dans la table <code>factions</code> de la base de donn√©es.</li>
                <li>Apr√®s ajout r√©ussi, l‚Äôutilisateur est redirig√© sur la m√™me page avec un message de succ√®s.</li>
            </ul>

            <p class="mt-2">
                Cette interface permet de maintenir facilement la liste des factions, qui sera ensuite utilis√©e par le
                filtre des unit√©s et vaisseaux pour g√©n√©rer dynamiquement les options de s√©lection.
            </p>
        </div>

        <!-- Section Ajout d'unit√©s -->
        <div class="section mt-4">
            <h2>Ajout / Modification d'une unit√©</h2>

            <p>
                Cette page permet de <strong>cr√©er ou modifier une unit√© (personnage)</strong> dans la base de donn√©es.
                Chaque unit√© contient plusieurs informations essentielles : ID unique, nom en anglais et fran√ßais, r√¥le,
                alignement, image, URL de page descriptive et factions associ√©es.
            </p>

            <!-- Capture d'√©cran -->
            <div class="text-center">
                <img src="image-projet/swgoh-creation-unit√©.jpg" alt="Page Ajout d'unit√©" class="img-placeholder">
            </div>

            <!-- Explications -->
            <h5 class="mt-3"><u>Fonctionnement du formulaire</u></h5>
            <ul>
                <li><strong>ID :</strong> identifiant unique de l'unit√©. Il est obligatoire et non modifiable lors de
                    l'√©dition d'une unit√© existante.</li>
                <br><br>
                <li><strong>Nom anglais et Nom fran√ßais :</strong> le nom anglais est la valeur principale utilis√©e pour
                    les recherches et filtres. Le nom fran√ßais est associ√© pour permettre l‚Äôaffichage dans la langue
                    locale du site.</li>
                <br><br>
                <li><strong>R√¥le et Alignement :</strong>
                    <ul>
                        <li>Le r√¥le et l‚Äôalignement sont s√©lectionn√©s dans des listes d√©roulantes en anglais.</li>
                        <li>Une traduction automatique est appliqu√©e dans les champs fran√ßais correspondants gr√¢ce √† des
                            dictionnaires pr√©-d√©finis en JavaScript.</li>
                        <li>Exemple‚ÄØ: si l‚Äôutilisateur choisit le r√¥le <em>attacker</em>, le champ fran√ßais est
                            automatiquement rempli avec <em>attaquant</em>. M√™me principe pour les alignements‚ÄØ:
                            <em>lightside ‚Üí c√¥t√© lumineux</em>, <em>darkside ‚Üí c√¥t√© obscur</em>.</li>
                        <li>Cette m√©thode garantit que toutes les unit√©s ont leurs valeurs en anglais et en fran√ßais
                            coh√©rentes, ce qui est n√©cessaire pour le filtrage multilingue et l‚Äôaffichage dynamique sur
                            le site.</li>
                    </ul>
                </li>
                <br><br>
                <li><strong>Factions :</strong>
                    <ul>
                        <li>Chaque unit√© peut appartenir √† plusieurs factions (Jedi, Sith, Empire, etc.).</li>
                        <li>Les factions disponibles sont affich√©es sous forme de boutons cliquables. Cliquer dessus
                            s√©lectionne ou d√©s√©lectionne la faction.</li>
                        <li>Les factions s√©lectionn√©es apparaissent sous forme de tags avec un bouton de suppression
                            rapide.</li>
                        <li>Le formulaire envoie ensuite les IDs de factions s√©lectionn√©es pour l‚Äôassociation dans la
                            table <code>unit_factions</code>, qui permet de relier dynamiquement chaque unit√© √† ses
                            factions.</li>
                        <li>Les noms anglais et fran√ßais des factions sont stock√©s dans la base et utilis√©s pour
                            l‚Äôaffichage et les filtres multilingues.</li>
                    </ul>
                </li>
                <br><br>
                <li><strong>Page et Image :</strong> champs pour indiquer l‚ÄôURL de la page descriptive et de l‚Äôimage du
                    personnage.</li>
                <br><br>
                <li><strong>Enregistrement :</strong>
                    <ul>
                        <li>Le formulaire v√©rifie que l‚ÄôID et le nom anglais sont remplis.</li>
                        <li>Les donn√©es sont ins√©r√©es ou mises √† jour dans les tables <code>units</code> et
                            <code>unit_factions</code> via PDO et des transactions SQL.</li>
                        <li>Si une erreur survient lors de l‚Äôenregistrement, toutes les modifications sont annul√©es pour
                            √©viter des incoh√©rences.</li>
                        <li>Apr√®s un ajout ou une modification r√©ussie, le formulaire est r√©initialis√© pour permettre un
                            nouvel enregistrement.</li>
                    </ul>
                </li>
            </ul>

            <p class="mt-2">
                Gr√¢ce √† cette interface, toutes les unit√©s sont correctement stock√©es avec leurs traductions et
                associations, ce qui permet ensuite d‚Äôalimenter les filtres dynamiques, l‚Äôaffichage multilingue et la
                g√©n√©ration du fichier JSON utilis√© par le site.
            </p>
        </div>

        <!-- Section Liste des unit√©s -->
        <div class="section mt-4">
            <h2>Liste des unit√©s enregistr√©es</h2>

            <p>
                Cette page affiche toutes les unit√©s pr√©sentes dans la base de donn√©es avec leurs informations compl√®tes
                :
                <strong>nom fran√ßais et anglais, r√¥le, alignement, factions, image et lien vers la page
                    descriptive</strong>.
                Elle permet √©galement de rechercher dynamiquement une unit√© et d‚Äôeffectuer des actions rapides comme
                modifier ou supprimer.
            </p>

            <!-- Capture d'√©cran -->
            <div class="text-center">
                <img src="image-projet/afficher-unit√©.jpg" alt="Exemple de liste d'unit√©s" class="img-placeholder">
                <p class="small mt-2">
                    Exemple : affichage de <strong>Padawan Sabine Wren</strong> et <strong>Sabine Wren</strong> avec
                    leurs factions et alignements.
                </p>
            </div>

            <!-- Explications -->
            <h5 class="mt-3">Fonctionnalit√©s principales</h5>
            <ul>
                <li><strong>Recherche instantan√©e :</strong> le champ en haut de la page filtre toutes les cartes
                    dynamiquement selon les noms, r√¥les, alignements et factions (FR et EN).</li>

                <li><strong>Affichage en cartes :</strong> chaque unit√© est pr√©sent√©e dans une carte contenant :
                    <ul>
                        <li>Image et noms (FR en titre, EN en sous-titre)</li>
                        <li>R√¥le et alignement, avec traduction automatique affich√©e √† c√¥t√© du terme anglais</li>
                        <li>Factions, affich√©es s√©par√©ment en FR et EN sous forme de tags color√©s</li>
                        <li>Lien vers la page descriptive de l‚Äôunit√© si disponible</li>
                        <li>Menu d‚Äôactions pour modifier ou supprimer l‚Äôunit√©</li>
                    </ul>
                </li>
                <br><br>
                <li><strong>Gestion des factions :</strong>
                    <ul>
                        <li>Les relations entre unit√©s et factions sont g√©r√©es via la table <code>unit_factions</code>.
                        </li>
                        <li>Chaque carte r√©cup√®re les factions associ√©es √† partir de cette table et affiche √† la fois le
                            nom fran√ßais et anglais.</li>
                    </ul>
                </li>
                <br><br>
                <li><strong>Modification et suppression :</strong>
                    <ul>
                        <li>Le menu d√©roulant permet de modifier l‚Äôunit√© (ouvre le formulaire de modification) ou de la
                            supprimer (avec confirmation).</li>
                        <li>La suppression supprime d‚Äôabord les associations dans <code>unit_factions</code>, puis
                            l‚Äôunit√© elle-m√™me pour √©viter les incoh√©rences.</li>
                    </ul>
                </li>
                <br><br>
                <li><strong>Export JSON :</strong> un lien permet de t√©l√©charger le fichier JSON de toutes les unit√©s,
                    utilis√© par le site pour l‚Äôaffichage dynamique et les filtres multilingues.</li>
            </ul>
            <br>
            <h5 class="mt-3">Exemple concret avec deux unit√©s</h5><br><br>
            <p>
                <strong>Padawan Sabine Wren :</strong> r√¥le <em>attacker / attaquant</em>, alignement <em>lightside /
                    c√¥t√© lumineux</em>, factions : Mandalorien, Spectre, Utilisateur de la Force non align√©.
                <br><br>
                <strong>Sabine Wren :</strong> r√¥le <em>attacker / attaquant</em>, alignement <em>lightside / c√¥t√©
                    lumineux</em>, factions : Mandalorien, Phoenix, Rebelle.
            </p>

            <p>
                Ces donn√©es sont automatiquement affich√©es dans les cartes avec leur image et lien vers la page
                sp√©cifique.
                Le syst√®me garantit que les valeurs fran√ßaises et anglaises sont correctement associ√©es pour chaque
                r√¥le, alignement et faction, ce qui permet le filtrage multilingue et un affichage coh√©rent.
            </p>
        </div>

        <!-- Section G√©n√©ration du JSON -->
        <div class="section mt-4">
            <h2>G√©n√©ration du fichier JSON</h2>

            <p>
                Ce script PHP permet de g√©n√©rer un fichier JSON contenant toutes les unit√©s enregistr√©es dans la base de
                donn√©es.
                Chaque unit√© inclut les informations en <strong>anglais et fran√ßais</strong> pour les champs nom, r√¥le,
                alignement et factions.
            </p>

            <h5>Fonctionnement :</h5>
            <ul>
                <li><strong>R√©cup√©ration des unit√©s :</strong> les colonnes EN et FR sont s√©lectionn√©es depuis la table
                    <code>units</code>.</li>
                <li><strong>R√©cup√©ration des factions :</strong> les relations sont extraites de la table
                    <code>unit_factions</code> et jointes √† la table <code>factions</code> pour obtenir les noms en EN
                    et FR.</li>
                <li><strong>Association des factions :</strong> chaque unit√© re√ßoit un tableau de factions associ√©es
                    avec leurs noms fran√ßais et anglais.</li>
                <li><strong>Tri des factions :</strong> certaines factions prioritaires (comme <em>Galactic Legend</em>,
                    <em>Leader</em>, <em>Fleet Commander</em>) sont tri√©es en t√™te. Les autres sont tri√©es par ordre
                    alphab√©tique en anglais.</li>
                <li><strong>Format final :</strong> chaque unit√© est repr√©sent√©e sous la forme :
                    <pre>
{
  "id": "unit_id",
  "name": { "en": "...", "fr": "..." },
  "role": { "en": "...", "fr": "..." },
  "alignment": { "en": "...", "fr": "..." },
  "factions": [ { "en": "...", "fr": "..." }, ... ],
  "page": "...",
  "image": "..."
}
      </pre>
                </li>
                <li><strong>Export :</strong> si le param√®tre <code>?download=1</code> est pr√©sent dans l‚ÄôURL, le
                    fichier JSON est propos√© en t√©l√©chargement. Sinon, le JSON est affich√© directement dans le
                    navigateur.</li>
            </ul>

            <h5>Exemple de sortie JSON :</h5>
            <pre>
[
  {
        "id": "padawan sabine wren",
        "name": {
            "en": "padawan sabine wren",
            "fr": "padawan sabine wren"
        },
        "role": {
            "en": "attacker",
            "fr": "attaquant"
        },
        "alignment": {
            "en": "lightside",
            "fr": "c√¥t√© lumineux"
        },
        "factions": [
            {
                "en": "mandalorian",
                "fr": "mandalorien"
            },
            {
                "en": "spectre",
                "fr": "spectre"
            },
            {
                "en": "unaligned force user",
                "fr": "utilisateur de la force non align√©"
            }
        ],
        "page": "https://e-rimbault.github.io/swgoh-kit/html/padawan-sabine.html",
        "image": "https://e-rimbault.github.io/swgoh-kit/image-perso/padawin/sabine-image.png"
    },
  {
        "id": "sabine wren",
        "name": {
            "en": "sabine wren",
            "fr": "sabine wren"
        },
        "role": {
            "en": "attacker",
            "fr": "attaquant"
        },
        "alignment": {
            "en": "lightside",
            "fr": "c√¥t√© lumineux"
        },
        "factions": [
            {
                "en": "mandalorian",
                "fr": "mandalorien"
            },
            {
                "en": "phoenix",
                "fr": "phoenix"
            },
            {
                "en": "rebel",
                "fr": "rebelle"
            }
        ],
        "page": "https://e-rimbault.github.io/swgoh-kit/html/sabine_wren.html",
        "image": "https://e-rimbault.github.io/swgoh-kit/image-perso/sabine-wren/sabine-image.png"
    },
]
  </pre>

            <p>
                Ce JSON constitue la base pour toutes les pages interactives du site, permettant d‚Äôafficher
                dynamiquement les unit√©s avec leurs traductions et factions.
                Gr√¢ce √† ce m√©canisme, toutes les modifications effectu√©es dans l‚Äôinterface d‚Äôadministration se refl√®tent
                automatiquement dans le fichier JSON.
            </p>
        </div>

        <!-- Retour -->
        <div class="text-center">
            <a href="projet-swgoh-wiki.html" class="btn btn-back">‚¨Ö Retour au projet</a>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>